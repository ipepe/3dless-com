THREE.STLLoader=function(t){this.manager=t!==undefined?t:THREE.DefaultLoadingManager},THREE.STLLoader.prototype={constructor:THREE.STLLoader,load:function(t,e,r,n){var a=this,o=new THREE.FileLoader(a.manager);o.setResponseType("arraybuffer"),o.load(t,function(t){try{e(a.parse(t))}catch(t){n&&n(t)}},r,n)},parse:function(t){function e(t){var e,r,n;if(n=new DataView(t),e=50,r=n.getUint32(80,!0),84+r*e===n.byteLength)return!0;for(var a=[115,111,108,105,100],o=0;o<5;o++)if(a[o]!=n.getUint8(o,!1))return!0;return!1}function r(t){for(var e,r,n,a,o,i,u,f,l=new DataView(t),s=l.getUint32(80,!0),g=!1,E=0;E<70;E++)1129270351==l.getUint32(E,!1)&&82==l.getUint8(E+4)&&61==l.getUint8(E+5)&&(g=!0,a=[],o=l.getUint8(E+6)/255,i=l.getUint8(E+7)/255,u=l.getUint8(E+8)/255,f=l.getUint8(E+9)/255);for(var d=84,c=50,p=new THREE.BufferGeometry,h=[],T=[],w=0;w<s;w++){var R=d+w*c,F=l.getFloat32(R,!0),y=l.getFloat32(R+4,!0),A=l.getFloat32(R+8,!0);if(g){var H=l.getUint16(R+48,!0);0==(32768&H)?(e=(31&H)/31,r=(H>>5&31)/31,n=(H>>10&31)/31):(e=o,r=i,n=u)}for(var b=1;b<=3;b++){var v=R+12*b;h.push(l.getFloat32(v,!0)),h.push(l.getFloat32(v+4,!0)),h.push(l.getFloat32(v+8,!0)),T.push(F,y,A),g&&a.push(e,r,n)}}return p.addAttribute("position",new THREE.BufferAttribute(new Float32Array(h),3)),p.addAttribute("normal",new THREE.BufferAttribute(new Float32Array(T),3)),g&&(p.addAttribute("color",new THREE.BufferAttribute(new Float32Array(a),3)),p.hasColors=!0,p.alpha=f),p}function n(t){for(var e,r=new THREE.BufferGeometry,n=/facet([\s\S]*?)endfacet/g,a=0,o=/[\s]+([+-]?(?:\d+.\d+|\d+.|\d+|.\d+)(?:[eE][+-]?\d+)?)/.source,i=new RegExp("vertex"+o+o+o,"g"),u=new RegExp("normal"+o+o+o,"g"),f=[],l=[],s=new THREE.Vector3;null!==(e=n.exec(t));){for(var g=0,E=0,d=e[0];null!==(e=u.exec(d));)s.x=parseFloat(e[1]),s.y=parseFloat(e[2]),s.z=parseFloat(e[3]),E++;for(;null!==(e=i.exec(d));)f.push(parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3])),l.push(s.x,s.y,s.z),g++;1!==E&&console.error("THREE.STLLoader: Something isn't right with the normal of face number "+a),3!==g&&console.error("THREE.STLLoader: Something isn't right with the vertices of face number "+a),a++}return r.addAttribute("position",new THREE.Float32BufferAttribute(f,3)),r.addAttribute("normal",new THREE.Float32BufferAttribute(l,3)),r}function a(t){return"string"!=typeof t?THREE.LoaderUtils.decodeText(new Uint8Array(t)):t}function o(t){if("string"==typeof t){for(var e=new Uint8Array(t.length),r=0;r<t.length;r++)e[r]=255&t.charCodeAt(r);return e.buffer||e}return t}var i=o(t);return e(i)?r(i):n(a(t))}};